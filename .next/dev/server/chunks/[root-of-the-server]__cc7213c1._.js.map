{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///D:/erp_project/src/app/lib/db.js"],"sourcesContent":["import mysql from 'mysql2/promise';\r\n\r\nconst dbConfig = {\r\n  host: process.env.DB_HOST,\r\n  user: process.env.DB_USER,\r\n  password: process.env.DB_PASSWORD,\r\n  database: process.env.DB_NAME,\r\n  port: process.env.DB_PORT,\r\n  waitForConnections: true,\r\n  connectionLimit: 30, // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô connection ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÉ‡∏ô pool\r\n  queueLimit: 0,\r\n  enableKeepAlive: true,\r\n  keepAliveInitialDelay: 10000,\r\n\r\n\r\n};\r\n\r\n// --- ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ Singleton ---\r\n// ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ pool ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ Global ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á? ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏¥‡∏°\r\n// ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ã‡πâ‡∏≥‡∏ï‡∏≠‡∏ô Hot Reload)\r\nlet pool;\r\n\r\n// üî• ‡∏ó‡∏µ‡πÄ‡∏î‡πá‡∏î 2: Singleton Pattern\r\n// ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤ \"‡πÄ‡∏Ñ‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏ß‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á?\"\r\nif (process.env.NODE_ENV === 'production') {\r\n  // ‡∏ñ‡πâ‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏à‡∏£‡∏¥‡∏á ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥\r\n  pool = mysql.createPool(dbConfig);\r\n} else {\r\n  // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏£‡∏≤ (Dev) ‡πÉ‡∏´‡πâ‡∏ù‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà Global\r\n  // ‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏•‡πâ‡∏ß Save ‡πÉ‡∏´‡∏°‡πà Next.js ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î ‡∏Å‡πá‡∏à‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏ó‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏° ‡πÑ‡∏°‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡∏ã‡πâ‡∏≠‡∏ô‡∏ó‡∏±‡∏ö‡∏Å‡∏±‡∏ô\r\n  if (!global.mysqlPool) {\r\n    global.mysqlPool = mysql.createPool(dbConfig);\r\n  }\r\n  pool = global.mysqlPool;\r\n}\r\n\r\nexport default pool;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,WAAW;IACf,MAAM,QAAQ,GAAG,CAAC,OAAO;IACzB,MAAM,QAAQ,GAAG,CAAC,OAAO;IACzB,UAAU,QAAQ,GAAG,CAAC,WAAW;IACjC,UAAU,QAAQ,GAAG,CAAC,OAAO;IAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO;IACzB,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;IACZ,iBAAiB;IACjB,uBAAuB;AAGzB;AAEA,2BAA2B;AAC3B,qEAAqE;AACrE,2DAA2D;AAC3D,IAAI;AAEJ,iCAAiC;AACjC,gDAAgD;AAChD;;KAGO;IACL,oDAAoD;IACpD,4FAA4F;IAC5F,IAAI,CAAC,yDAAO,SAAS,EAAE;QACrB,yDAAO,SAAS,GAAG,8IAAK,CAAC,UAAU,CAAC;IACtC;IACA,OAAO,yDAAO,SAAS;AACzB;uCAEe"}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["file:///D:/erp_project/src/app/api/production/projects/create/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport pool from '../../../../lib/db'; \r\n\r\nexport async function POST(request) {\r\n  try {\r\n    const body = await request.json();\r\n    const { \r\n        project_name, \r\n        customer_name, \r\n        start_date, \r\n        due_date, \r\n        budget, \r\n        sale_price, \r\n        quantity,      // ‚úÖ 1. ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (Quantity) ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô\r\n        description, \r\n        selected_employees \r\n    } = body;\r\n\r\n    const connection = await pool.getConnection();\r\n    await connection.beginTransaction();\r\n\r\n    try {\r\n        // ‚úÖ 2. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå quantity ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô SQL INSERT\r\n        const [result] = await connection.query(\r\n            `INSERT INTO projects (\r\n                project_name, customer_name, start_date, due_date, \r\n                budget, sale_price, quantity, description, status\r\n            ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, 'pending')`,\r\n            [\r\n                project_name, \r\n                customer_name, \r\n                start_date, \r\n                due_date, \r\n                budget || 0,\r\n                sale_price || 0, \r\n                quantity || 1,   // ‚úÖ 3. ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏•‡∏á‡πÑ‡∏õ (Default ‡πÄ‡∏õ‡πá‡∏ô 1)\r\n                description\r\n            ]\r\n        );\r\n        \r\n        const newProjectId = result.insertId;\r\n\r\n        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)\r\n        if (selected_employees && selected_employees.length > 0) {\r\n            for (const empCode of selected_employees) {\r\n                await connection.query(\r\n                    `INSERT INTO project_members (project_id, employee_id, role) VALUES (?, ?, 'Staff')`,\r\n                    [newProjectId, empCode]\r\n                );\r\n            }\r\n        }\r\n\r\n        // ‚úÖ 4. ‡∏õ‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Log ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢\r\n        await connection.query(\r\n            `INSERT INTO production_logs (project_id, action, note, employee_id) VALUES (?, ?, ?, ?)`,\r\n            [\r\n              newProjectId, \r\n              '‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡πÉ‡∏´‡∏°‡πà', \r\n              `‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${quantity || 1} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£, ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: ${budget || 0} ‡∏ö‡∏≤‡∏ó`, \r\n              'Admin'\r\n            ]\r\n        );\r\n\r\n        await connection.commit();\r\n        connection.release();\r\n\r\n        return NextResponse.json({ success: true, projectId: newProjectId });\r\n\r\n    } catch (err) {\r\n        if (connection) {\r\n          await connection.rollback();\r\n          connection.release();\r\n        }\r\n        throw err;\r\n    }\r\n\r\n  } catch (error) {\r\n    return NextResponse.json({ error: error.message }, { status: 500 });\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EACF,YAAY,EACZ,aAAa,EACb,UAAU,EACV,QAAQ,EACR,MAAM,EACN,UAAU,EACV,QAAQ,EACR,WAAW,EACX,kBAAkB,EACrB,GAAG;QAEJ,MAAM,aAAa,MAAM,oIAAI,CAAC,aAAa;QAC3C,MAAM,WAAW,gBAAgB;QAEjC,IAAI;YACA,iDAAiD;YACjD,MAAM,CAAC,OAAO,GAAG,MAAM,WAAW,KAAK,CACnC,CAAC;;;wDAG2C,CAAC,EAC7C;gBACI;gBACA;gBACA;gBACA;gBACA,UAAU;gBACV,cAAc;gBACd,YAAY;gBACZ;aACH;YAGL,MAAM,eAAe,OAAO,QAAQ;YAEpC,0BAA0B;YAC1B,IAAI,sBAAsB,mBAAmB,MAAM,GAAG,GAAG;gBACrD,KAAK,MAAM,WAAW,mBAAoB;oBACtC,MAAM,WAAW,KAAK,CAClB,CAAC,kFAAkF,CAAC,EACpF;wBAAC;wBAAc;qBAAQ;gBAE/B;YACJ;YAEA,6CAA6C;YAC7C,MAAM,WAAW,KAAK,CAClB,CAAC,uFAAuF,CAAC,EACzF;gBACE;gBACA;gBACA,CAAC,OAAO,EAAE,YAAY,EAAE,mBAAmB,EAAE,UAAU,EAAE,IAAI,CAAC;gBAC9D;aACD;YAGL,MAAM,WAAW,MAAM;YACvB,WAAW,OAAO;YAElB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAM,WAAW;YAAa;QAEtE,EAAE,OAAO,KAAK;YACV,IAAI,YAAY;gBACd,MAAM,WAAW,QAAQ;gBACzB,WAAW,OAAO;YACpB;YACA,MAAM;QACV;IAEF,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF"}}]
}